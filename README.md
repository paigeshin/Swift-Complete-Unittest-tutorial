# The Test-Driven Development Life Cycle (Red → Green → Refactor → Repeat)

### Red

- Write Unit test that fails

### Green

- Write App code to make Unit test pass

### Refactor

- Clean up and improve Unit test and app code

### Repeat

- Repeat these steps until all your app features are built and tested

[https://www.udemy.com/course/unit-testing-ios-mobile-app/learn/lecture/16502198#overview](https://www.udemy.com/course/unit-testing-ios-mobile-app/learn/lecture/16502198#overview)

[Unit Test Introduction ](https://www.notion.so/Unit-Test-Introduction-127dd3d1868b41a08015de00a8141e59)

[Testing Pyramid](https://www.notion.so/Testing-Pyramid-e0ac89c45f6642b7bed9e629e201e29b)

[F.I.R.S.T Principle](https://www.notion.so/F-I-R-S-T-Principle-f2648e738f714e039fe7d465fe3ea4a2)

[Test-Driven Development Lifecycle](https://www.notion.so/Test-Driven-Development-Lifecycle-3df50bf18ba9436d8b8f15cf3e3363dd)

[Swift Test Case Class Explained](https://www.notion.so/Swift-Test-Case-Class-Explained-378ef2a333ca4268a3deab8d49aafa07)

[The Order of Unit Tests](https://www.notion.so/The-Order-of-Unit-Tests-b2b0c0b46d104acf8b4f209372206c39)

[Unit Test Naming](https://www.notion.so/Unit-Test-Naming-853707ff035844239f0bd553812645c1)

[Code Coverage](https://www.notion.so/Code-Coverage-a6de7dd08e4e44feb7a0434c96ff4057)

[AAA Pattern, Arrange Act Assert](https://www.notion.so/AAA-Pattern-Arrange-Act-Assert-506c9c19635640c9abd66664f8352205)

[Test Assertion Methods ](https://www.notion.so/Test-Assertion-Methods-0b78abc1ae5d4c0eb0cc2e4819429557)

[How to enable Unit Test Breakpoint](https://www.notion.so/How-to-enable-Unit-Test-Breakpoint-44d726dc194e407bb1057a2b01fc3fdf)

[Parallel Distributed Testing on Multile Simulator Clones](https://www.notion.so/Parallel-Distributed-Testing-on-Multile-Simulator-Clones-138aeca7a8a344429c82ec08171af8cb)

[Dependency Injection & Protocols](https://www.notion.so/Dependency-Injection-Protocols-475bead129104f5cb189930142bf9b84)

[Test Doubles Fake, Dummy, Stub, Mock](https://www.notion.so/Test-Doubles-Fake-Dummy-Stub-Mock-424af778e3124da78918b8d72e2a0d85)

[TDD, Implementing Network Service Class](https://www.notion.so/TDD-Implementing-Network-Service-Class-42402c274d6b4c3182eb2dd3d3cf25b9)

[Check code coverage file by file ](https://www.notion.so/Check-code-coverage-file-by-file-ef6f5be1373c4cf7b7cbda393453a090)

[Testing UIViewController, The Strategy](https://www.notion.so/Testing-UIViewController-The-Strategy-62fe63bddad0415eb2bc24a08e116e1e)

[Guide - Refactor Legacy Code](https://www.notion.so/Guide-Refactor-Legacy-Code-9d2d135e3f66439eb10750754c8a7df3)

[Test ViewControllers Three Ways](https://www.notion.so/Test-ViewControllers-Three-Ways-2d12049fe363479d8f9b0a7884bf81ab)

[Throw Error Test](https://www.notion.so/Throw-Error-Test-1b4e5b23be8e4ffe9774d063f0c9c087)

[TextField Test ](https://www.notion.so/TextField-Test-324d735b00bc4b64b7e152e2827751f5)

[Test Navigation Controller](https://www.notion.so/Test-Navigation-Controller-d8284e4b9bc946488ed3d3e63d41ee42)

[UITest](https://www.notion.so/UITest-e55e9036284a4f1780c06581b2e1ff31)

[Accessiblity](https://www.notion.so/Accessiblity-5f11a05d15cf4689b093e1eeb712b215)

[Getting Instructions when testing UI](https://www.notion.so/Getting-Instructions-when-testing-UI-1f9e187d3f494ed3adbbd38eaeab129f)

[UI Testing](https://www.notion.so/UI-Testing-1523593a64a04aacb3312f44505ade31)

[Wait ViewController to be loaded](https://www.notion.so/Wait-ViewController-to-be-loaded-71394235e49a4b29bd3186ea995bafc2)

[XCUIElement Actions and Gestures](https://www.notion.so/XCUIElement-Actions-and-Gestures-894b0e1ef92c468aac91b644aaf8070e)

[Screenshots](https://www.notion.so/Screenshots-3127b92181374f95b004fd001d00ceb2)

[Launch Argument & Launch Environment ](https://www.notion.so/Launch-Argument-Launch-Environment-6bf6cf9811254a0e8d71bcddc26f0a64)

# Code Example

[Basic Unit Test ](https://www.notion.so/Basic-Unit-Test-5b8e7af33cb2442d82476d9c3ed74840)

[API](https://www.notion.so/API-d9658966299242fba9a004b7e2385faa)

[MVP, presenter, validator ](https://www.notion.so/MVP-presenter-validator-389ab0b6481742acb035693979eedb2c)

[MVP, presenter webservice](https://www.notion.so/MVP-presenter-webservice-aad4c2ba776b4a95a0cfcc730bbee13c)

[MVP, Test MVP ViewDelegate](https://www.notion.so/MVP-Test-MVP-ViewDelegate-074b6ab30a684d81a0df2685ffca64f1)

[MVP ViewController,](https://www.notion.so/MVP-ViewController-c20486ab0fb54949b9fad9901243872b)

[Test ViewControllers Three Ways](https://www.notion.so/Test-ViewControllers-Three-Ways-2d12049fe363479d8f9b0a7884bf81ab)

[Throw Error Test](https://www.notion.so/Throw-Error-Test-1b4e5b23be8e4ffe9774d063f0c9c087)

[TextField Test](https://www.notion.so/TextField-Test-324d735b00bc4b64b7e152e2827751f5)

[UI Testing](https://www.notion.so/UI-Testing-1523593a64a04aacb3312f44505ade31)

[Wait ViewController to be loaded](https://www.notion.so/Wait-ViewController-to-be-loaded-71394235e49a4b29bd3186ea995bafc2)

[Screenshots](https://www.notion.so/Screenshots-3127b92181374f95b004fd001d00ceb2)

[Launch Argument & Environment](https://www.notion.so/Launch-Argument-Launch-Environment-6bf6cf9811254a0e8d71bcddc26f0a64)

# Checklist

- You don’t necessarily add tests, you can add it later.

### Config

- [ ] [Enable Test Coverage](https://www.notion.so/Code-Coverage-a6de7dd08e4e44feb7a0434c96ff4057)
- [ ] [Test Failure Breakpoint](https://www.notion.so/How-to-enable-Unit-Test-Breakpoint-44d726dc194e407bb1057a2b01fc3fdf)
- [ ] [Check code coverage file by file](https://www.notion.so/Check-code-coverage-file-by-file-ef6f5be1373c4cf7b7cbda393453a090)

### Optionals..

- [ ] [Screenshot](https://www.notion.so/Screenshots-3127b92181374f95b004fd001d00ceb2)
- [ ] [Run multiple test devices if needed (Optional)](https://www.notion.so/Parallel-Distributed-Testing-on-Multile-Simulator-Clones-138aeca7a8a344429c82ec08171af8cb)
- [ ] [Refactor Old Legacy Code](https://www.notion.so/Guide-Refactor-Legacy-Code-9d2d135e3f66439eb10750754c8a7df3)
- [ ] [UI Testing `po app` with debug break point](https://www.notion.so/Getting-Instructions-when-testing-UI-1f9e187d3f494ed3adbbd38eaeab129f)
- [ ] [Accessibility](https://www.notion.so/Accessiblity-5f11a05d15cf4689b093e1eeb712b215)
- [ ] [XCUI Elements and Devices](https://www.notion.so/XCUIElement-Actions-and-Gestures-894b0e1ef92c468aac91b644aaf8070e)
- [ ] [Launch Argument & Environment](https://www.notion.so/Launch-Argument-Launch-Environment-6bf6cf9811254a0e8d71bcddc26f0a64)
- [ ] [Assertion Methods](https://www.notion.so/Test-Assertion-Methods-0b78abc1ae5d4c0eb0cc2e4819429557)
- [ ] [Test Plans](https://www.udemy.com/course/unit-testing-ios-mobile-app/learn/lecture/19044690#overview)

# Unit Test

- A Unit test test is very small function that you write to test some part of your code.
- Unit test is also a code that you write, but it is very small and it is very simple code and it does not contain much of a business logic.

# Testing Pyramid

1. Unit tests → Testing isolated small pieces of code with Fake or Mock dependencies
2. Integration Tests → App code is tested without faking database or HTTP Connections
3. UI Tests → Automated tests to test User Interface Interaction and Behavior

# F.I.R.S.T Principle

1. **F**ast - Unit tests run fast
2. **I**ndependent - Unit tests are independent
3. **R**epeatable - Unit tests are repeatable
4. **S**elf-validating - Unit test validates itself
5. **T**horough & **T**imely - Cover edge cases

# The Test-Driven Development Life Cycle (Red → Green → Refactor → Repeat)

### Red

- Write Unit test that fails

### Green

- Write App code to make Unit test pass

### Refactor

- Clean up and improve Unit test and app code

### Repeat

- Repeat these steps until all your app features are built and tested

# Unit Test Case Class Explained

```swift
//
//  MyAppTests.swift
//  MyAppTests
//
//  Created by paige on 2021/12/25.
//

import XCTest
@testable import MyApp

class MyAppTests: XCTestCase {

    // Called One time per each Test Case Class
    override class func setUp() { // 1.
        print("*** Class setUp() method is called")
    }

    override func setUpWithError() throws { // 2.
        print("*** Instance setUpWithError() is called")
    }

    override class func tearDown() {
        print("*** Class tearDown() method is called")
    }

    override func tearDownWithError() throws {
        print("*** Instance tearDown() method is called")
    }

    func testExample() throws { // 3.
        print("*** Test method is called")
        addTeardownBlock { // 4.
            // Called when testExample() ends.
            print("*** TeardownBlock is called when test method ends")
        }
    }

}
```

# The Order of Unit Tests

1. Alphabetically(Lexical) ordered,
2. Randomized,
3. Executed in parallel

# Unit Test Naming

### Unit Test method Requirements

```swift
func testColorlsRed() {

	// Some code here

}
```

- Each test method must begin with the prefix `**test**`.
- Test method does not take arguments
- Test method does not return a value

### Pattern

```swift
func test<System Under Test>_<Codition Or State Change>_<Expected Result>() {

}
```

### Example

```swift
func testSignupFormModel_WhenInformationProvided_PasswordShouldMatchRepeatPassword() {

}
```

# AAA Pattern, Arrange Act Assert

```swift
func testSignupFormModel_WhenInformationProvided_PasswordsShouldMatch() {

		// Arrange
		let firstName = "Paige"
		let lastName = "Shin"
		let email = "test@test.com"
		let password = "1234567"
		let repeatPassword = "1234567"
		let sut = SignupFormModel(firstName, lastName, email, password, repeatPassword)

		// Act
		let passwordsMatch = sut.doPasswordsMatch()

		// Assert
		XCTAssertTrue(passwordsMatch, "Exepected TRUE value for 'passwordsMatch' but apparently it is FALSE")

}
```

# How to enable unit test Breakpoint

[https://www.notion.so/How-to-enable-Unit-Test-Breakpoint-44d726dc194e407bb1057a2b01fc3fdf](https://www.notion.so/How-to-enable-Unit-Test-Breakpoint-44d726dc194e407bb1057a2b01fc3fdf)

# Test Doubles Fake, Dummy, Stub, Mock

### Fake

- In-memory storage instead of a permanent storage

### Dummy

- Placeholder

```swift
let mockSignup = MockSignupWebService()

mockSignup.signupUser(SignupFormModelDummy())
mockSignup.signupUser(SignupFormModelDummy())
mockSignup.signupUser(SignupFormModelDummy())

struct SignupFormModelDummy: SignupFormModelProtocol {
	var firstName = "abc"
  var lastName = "abc"
  var email = "abc"
  var password = "abc"
}
```

### Stub

- Behave in a certain way, depending on the value that this type of object contains the following class as an example of a stamp

```swift
class ValidSignupFormModelValidatorStub {

	func isFirstNameValid(firstName: String) -> Bool {
		return true
	}

	func isLastNameValid(lastName: String) -> Bool {
		return true
	}

	func isValidEmailFormat(email: String) -> Bool {
		return true
	}

}
```

⇒ It has functions that always return predefined data, no matter what input parameters they get

### Mock

- Mock objects are similar to fake objects, except that mock objects might not even have a simple implementation

```swift
class MockSignupWebService: SignupWebServiceProtocol {

	var processUserSignupCalled = false
	var processUserSignupCalledNumberOfTimes = 0

	func processUserSignup(formModel: SignupFormModel) {
		processUserSignupCalled = true
		processUserSignupCalledNumberOfTimes += 1
	}

}
```

⇒ Unlike Fake Object, it does not attempt to store user details in memory or stored in a temporary location. It simply registers the fact that the process user said the method was called and it counts the number of times that the method was called

# XCUI elements actions and gestures

### Actions

- emailTextField**.tap()**, emailTextField**.typeText()**
- signupButton**.tap()**

---

- doubleTap()
- twoFingerTap()
- tap(withNumberOfTaps numberOfTaps: Int, numberOfTouches: Int)
- press(forDuration duration: TimeInterval)
- press(forDuration duration: TimeInterval, thenDragTo otherElement: XCUIElement)
- swipeUp(), swipeDown(), swipeRight(), swipeLeft()
- pinch(withScale scale: CGFloat, velocity: CGFloat)
- rotate(\_ rotation: CGFloat, withVelocity velocity: CGFloat)
- adjust(toNormalizedSliderPosition normalizedSliderPosition: CGFloat)

### XCUI Device

let device = XCUIDevice.shard

device.orientation = .landscapeRight

device.press(.home)

let siri = device.siriService

siri.activate(voiceRecognitionText: “”)
